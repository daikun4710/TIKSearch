<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <link rel="stylesheet" href="https://pyscript.net/latest/pyscript.css" />
  <script defer src="https://pyscript.net/latest/pyscript.js"></script>
  <title>Google Map with Info Window and Link</title>
  <style>
     body{
      margin:0;
    }

    #map {
      height: 400px;
      width: 100%;
    }

    #addressesList {
      position: absolute;
      top: 430px;
    }

    .serach {
      position: absolute;
      top: 380px;
      left: 10px;
      font-size: 25px;
    }

    ul {
      counter-reset: number;
      /* ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã‚’ãƒªã‚»ãƒƒãƒˆ */
      list-style-type: none !important;
      /* ç•ªå·ã‚’æ¶ˆã™ */
      padding: 0.3em 0.8em;
      border: solid 2px #ffb107;
    }

    ul li {
      border-bottom: dashed 1px orange;
      position: relative;
      padding: 0.5em 0.5em 0.5em 30px;
      line-height: 1.5em;
      counter-increment: number;
      /* å„liè¦ç´ ã”ã¨ã«ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã‚’å¢—ã‚„ã™ */
    }

    ul li:after {
      /* ã“ã“ã§ç•ªå·ã‚’æŒ‡å®š */
      position: absolute;
      content: counter(number);
      /* ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã®å€¤ã‚’è¡¨ç¤º */
      /* ç•ªå·ã®ã‚¹ã‚¿ã‚¤ãƒ« */
      display: inline-block;
      background: #ffb107;
      color: white;
      font-family: 'Avenir', 'Arial Black', 'Arial', sans-serif;
      font-weight: bold;
      font-size: 15px;
      border-radius: 50%;
      left: 0;
      width: 25px;
      height: 25px;
      line-height: 25px;
      text-align: center;
      /* ç¸¦æ–¹å‘ã®ä¸­å¤®æƒãˆ */
      top: 50%;
      -webkit-transform: translateY(-50%);
      transform: translateY(-50%);
    }

    ul li:last-of-type {
      border-bottom: none;
      /* æœ€å¾Œã®liã®ç·šã ã‘æ¶ˆã™ */
    }
  </style>
</head>
<body>
  <p class="serach">æ¤œç´¢ä¸€è¦§ğŸ”</p>
  <div id="map"></div>
  <div>
    <ul id="addressesList">
    </ul>
  </div>
  <canvas id="Canvas"></canvas>
  <script>
    var map;
    var infoWindow;
    function initMap() {
      // ãƒãƒƒãƒ—ã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’è¨­å®š
      var mapOptions = {
        center: { lat: 0, lng: 0 }, // ãƒãƒƒãƒ—ã®åˆæœŸä¸­å¿ƒä½ç½®
        zoom: 15, // ã‚ºãƒ¼ãƒ ãƒ¬ãƒ™ãƒ«ï¼ˆ1ãŒæœ€å°ã€20ãŒæœ€å¤§ï¼‰
      };
      // åœ°å›³ã‚’ä½œæˆ
      map = new google.maps.Map(
        document.getElementById("map"),
        mapOptions
      );
      // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ç¾åœ¨ä½ç½®ã‚’å–å¾—ã—ã¦åœ°å›³ä¸Šã«è¡¨ç¤º
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
          function (position) {
            var userLocation = {
              lat: position.coords.latitude,
              lng: position.coords.longitude,
            };
            // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ä½ç½®ã«ãƒãƒ¼ã‚«ãƒ¼ã‚’è¿½åŠ 
            new google.maps.Marker({
              position: userLocation,
              map: map,
              title: "ç¾åœ¨ã®ä½ç½®",
            });
            // ãƒãƒƒãƒ—ã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ä½ç½®ã«ç§»å‹•
            map.setCenter(userLocation);
            map.setZoom(15);
          },
          function (error) {
            // ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
            console.error(
              "ä½ç½®æƒ…å ±ã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚ã‚¨ãƒ©ãƒ¼: " + error.message
            );
          }
        );
      } else {
        // ãƒ–ãƒ©ã‚¦ã‚¶ãŒä½ç½®æƒ…å ±ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ãªã„å ´åˆã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
        console.error("ã“ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯ä½ç½®æƒ…å ±ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã›ã‚“ã€‚");
      }
      // æƒ…å ±ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’åˆæœŸåŒ–
      infoWindow = new google.maps.InfoWindow();
      // ãƒ”ãƒ³ã‚’ç«‹ã¦ãŸã„ä½æ‰€
      var addressArray = [
        "æ°´æ·±162cmã®æ—¥æœ¬ä¸€æ·±ã„æ¸©æ³‰ãŒã‚„ã°ã™ããŸâ€¦173cmã®ä¿ºã¯æ¯å‡ºæ¥ãªã‹ã£ãŸğŸ¤£ ğŸ“ç†Šæœ¬çœŒå—å°å›½ç”ºã€€ã“ã†ã®æ¹¯ #ç†Šæœ¬ #ã“ã†ã®æ¹¯ #ç†Šæœ¬æ¸©æ³‰",
        "ç³¸å³¶ã§1ç•ªã†ã¾ã„ã¨å™‚ã®ç„¼è‚‰å±‹ã•ã‚“èª¿æŸ»ã—ã¦ããŸã‚«ãƒ³ã‚¸ãƒ£ãƒ³ã‚±ã‚¸ãƒ£ãƒ³é£Ÿã¹æ”¾é¡Œã¯æœ€é«˜ã™ãã‚‹ğŸ“ç¦å²¡çœŒç³¸å³¶å¸‚ã€€#ä¸Šã®ç„¼è‚‰å±‹\ãŠåº—ã®å…¬å¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆâ†’ @ueno.yakinikuyaOpen 11:00ã€œ20:00â€»æ°´æ›œå®šä¼‘æ—¥",
        "ã¾ã‚‹ã§ãƒ†ãƒ¼ãƒãƒ‘ãƒ¼ã‚¯ã¿ãŸã„ãªç¦å²¡ã®ç©´å ´çµ¶æ™¯ãƒ›ãƒ†ãƒ«ãŒæœ€é«˜ã™ããŸä»¶ã«ã¤ã„ã¦ğŸ˜³â™¨ï¸ä¸€è¦‹ã‚ã¡ã‚ƒãã¡ã‚ƒé«˜ãã†ã«è¦‹ãˆã‚‹ã“ã®ãƒ›ãƒ†ãƒ«â€¦ã“ã“ã ã‘ã®è©±æ„å¤–ã¨ãŠæ‰‹é ƒãªå€¤æ®µã§æ³Šã¾ã‚Œã¡ã‚ƒã†ã‚“ã ğŸ¤«å¤§äººæ•°ã§ã‚‚æ³Šã¾ã‚Œã‚‹ã—ä»Šã‹ã‚‰ã®å¿˜å¹´ä¼šã‚·ãƒ¼ã‚ºãƒ³ã«ã‚‚æŒã£ã¦ã“ã„ã®å®¿ã ãœâ¤ï¸â€ğŸ”¥ğŸ‘ğŸ»ğŸ“ç¦å²¡çœŒå²¡å£ç”ºã€€#æµ·è¾ºã®é®¨å®¿å…«å¹¡å±‹â€»äºˆç´„æ–¹æ³•ã‚„ãƒ—ãƒ©ãƒ³ã®æ–™é‡‘è©³ç´°ã¯å…¬å¼ã‚µã‚¤ãƒˆã‹ã‚‰ãƒã‚§ãƒƒã‚¯ã—ã¦ã­ğŸ”¥"
      ];
      // Log and display each address in the array
      var addressesList = document.getElementById("addressesList");
      for (var i = 0; i < addressArray.length; i++) {
        console.log("Address " + (i + 1) + ": " + addressArray[i]);
        // Display addresses as a list
        addressesList.innerHTML += "<li>SPOT " + (i + 1) + ":" + addressArray[i] + "</li>";
      }
      // ã‚¸ã‚ªã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’å®Ÿè¡Œ
      for (var i = 0; i < addressArray.length; i++) {
        geocodeAddress(addressArray[i]);
      }
    }
    function geocodeAddress(address) {
      var geocoder = new google.maps.Geocoder();
      geocoder.geocode({ address: address }, function (results, status) {
        if (status === "OK") {
          var location = results[0].geometry.location;
          // ãƒ”ãƒ³ã‚’ä½œæˆ
          var marker = new google.maps.Marker({
            position: location,
            map: map,
            title: address,
          });
          // è©³ç´°æƒ…å ±ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®å†…å®¹
          var contentString =
            "<div>ã‚µãƒ³ãƒ—ãƒ«<h3>" +
            address +
            '</h3><p>è©³ç´°æƒ…å ±ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</p><p><a href="https://www.tiktok.com/@yuuuuto38/video/7293401284609150216?q=%E7%A6%8F%E5%B2%A1%E8%A6%B3%E5%85%89&t=7150595195619282178" target="_blank">ã‚µã‚¤ãƒˆã¸ã®ãƒªãƒ³ã‚¯</a></p></div>';
          // ãƒ”ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸã¨ãã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
          marker.addListener("click", function () {
            // è©³ç´°æƒ…å ±ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã«å†…å®¹ã‚’ã‚»ãƒƒãƒˆ
            infoWindow.setContent(contentString);
            // ãƒ”ãƒ³ã®ä½ç½®ã«ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’è¡¨ç¤º
            infoWindow.open(map, marker);
          });
        } else {
          alert("ã‚¸ã‚ªã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã«å¤±æ•—ã—ã¾ã—ãŸ: " + status);
        }
      });
    }
    var dataArray = JSON.parse(localStorage.getItem("Addresses"));
    //æ¤œç´¢æƒ…å ±å‡ºåŠ›
    console.log(dataArray);
  </script>
  <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCUqiDP-1T8cxCyJRYrel2GIcAlz5_vgAE&callback=initMap"></script>
</body>
</html>